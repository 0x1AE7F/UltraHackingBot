import requests
from bs4 import BeautifulSoup

def search_cve_mitre(query="XSS"):
    r = requests.get(f"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword={query}")
    soup = BeautifulSoup(r.content, 'html.parser')
    description_count = 1
    link_count = 1
    exploit_link = ""
    exploit_desc = ""
    for found_entry in soup.find_all('td'):
        if not (description_count < 1 and link_count < 1):
            if "<td valign=\"top\">" in str(found_entry):
                #print(found_entry.text)
                exploit_desc = str(found_entry.text)
                description_count = description_count -1
            if "<td nowrap=\"nowrap\" valign=\"top\"><a href" in str(found_entry):
                #print(str(found_entry).replace("<td nowrap=\"nowrap\" valign=\"top\"><a href=\"", "").replace("</a></td>", ""))
                exploit_link = "https://cve.mitre.org"+str(found_entry).replace("<td nowrap=\"nowrap\" valign=\"top\"><a href=\"", "").replace("</a></td>", "")
                link_count = link_count - 1
        else:
            return exploit_desc, exploit_link, f"https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword={query}"
